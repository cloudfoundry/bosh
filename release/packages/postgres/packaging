set -e -x

tar xzf postgres/postgresql-9.0.23.tar.gz
cd postgresql-9.0.23

if [ "`uname -m`" == "ppc64le" ]; then
 cd config
 curl "http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.guess;hb=HEAD" > config.guess
 curl "http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.sub;hb=HEAD" > config.sub
 cd ../
fi

./configure --prefix=$BOSH_INSTALL_TARGET

pushd src/bin/pg_config
make
make install
popd

cp -LR src/include ${BOSH_INSTALL_TARGET}
pushd src/interfaces/libpq
make
make install
popd

pushd src
make
make install
popd

pushd contrib
make
make install
popd
